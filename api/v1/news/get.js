export default function handler(req, res) {
  const { count = 4 } = req.query;
  const newsCount = Math.min(parseInt(count, 10), 20); // лимит 20 на запрос

  const NEWS = [
    {
      title: "Вышло приложение с новостями",
      img: "/img/news/card1.png",
      date: "2025-09-14",
      description: "Выход новой версии нашей ОС привел к появлению нового системного приложения, а именно «Новости системы». Приложение «Новости системы» позволяет пользователям узнать о нововведениях и обновлениях системы,  не заходя в браузер.. Если же информация устаревшая даже при переходе на новую версию системы, то пользователи могут узнать о текущих нововведениях и обновлениях на нашем сайте в разделе «Новости» или же обратиться в службу поддержки. Для того чтобы открыть приложение «Новости системы», нужно кликнуть на кнопку «Старт меню» , и далее в поиске набрать имя приложения.",
      author: "SmartfordOS Insider"
    },
    {
      title: "Релиз SmartfordOS beta 1.2. Что нового?",
      img: "/img/news/card2.png",
      date: "2025-09-31",
      description: "31 августа 2025 года вышла первая общедоступная версия нашей ОС. Был окончательно доделан установщик системы, «Старт-меню», интерфейс проводника и медиа плеера. Скачать текущую версию системы можно с нашего сайта или Telegram канала. Однако данная версия еще не является окончательным релизом. В данной версии могут присутствовать баги и ошибки. Если у вас есть проблемы, обращайтесь в поддержку Telegram",
      author: "SmartfordOS Insider"
    },
    {
      title: "Новые темы для SmartfordOS",
      img: "/img/news/card3.png",
      date: "2026-01-08",
      description: "Теперь можно менять обои и темы оформления прямо из настроек.",
      author: "SmartfordOS Insider"
    },
    {
      title: "Официальный релиз Smartford OS 1.0",
      img: "/img/news/card4.png",
      date: "2025-12-01",
      description: "Вышла официальная версия нашей ОС. SMOS Браузер официально начал свою работу, был расширен функционал проводника (были добавлены рабочие папки на дисках) и немного обновлена панель задач. Скачать текущую версию системы можно с нашего сайта или Telegram канала. ",
      author: "SmartfordOS Insider"
    },
    {
      title: "Официальный релиз Smartford OS 1.0",
      img: "/img/news/card4.png",
      date: "2026-01-??",
      description: "Smartford OS получила новый дизайн, совершенно уникальный и новый дизайн. В нём появилась размытость, а также motion-анимации в некоторых местах, Smartford OS после этого – совершенно новая и революционная система, дизайнерская команда Smartford OS делала это с усилиями и подходом к современному дизайну, а также эффекты стекла (почти) и glassmorphism. Также Smartford OS получила растянутые шрифты.",
      author: "SmartfordOS Insider"
    }
  ];

  // Берём только нужное количество
  const selectedNews = NEWS.slice(0, newsCount).map(item => ({
    ...item,
    preview_url: `https://smartford.vercel.app/api/v1/news/compress?size=144&img=${encodeURIComponent(item.img)}`
  }));

  res.status(200).json({
    count: selectedNews.length,
    data: selectedNews
  });
}
